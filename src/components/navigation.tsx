'use client'

import { useState } from 'react'
import Link from 'next/link'
import { Button } from "@/components/ui/button"
import { Menu, X } from 'lucide-react'
import { useRouter } from 'next/navigation'
import { useSession, signOut } from "next-auth/react"

const navItems = [
  { name: 'Prompt Formeln', href: '/prompt-formeln' },
  { name: 'Bilder Galerie', href: '/images' },
  { name: 'Bildstile & Referenzen', href: '/stile-referenzen' },
  { name: 'Preise', href: '/pricing' },
]

export default function Navigation() {
  const [isOpen, setIsOpen] = useState(false)
  const router = useRouter()
  const { data: session } = useSession()

  const handleLogout = async () => {
    await signOut({
      callbackUrl: '/',
      redirect: true
    })
  }

  return (
    <nav className="bg-background border-b">
      <div className="w-full mx-auto px-4 sm:px-6 lg:px-8">
        <div className="flex items-center justify-between h-16">
          <div className="flex items-center">
            <Link href="/" className="flex-shrink-0 flex items-center gap-2">
              <svg width="40" height="40" viewBox="0 0 271.167 271.833">
                <path fill="#170338" d="M99.072,3.122c3.887,0.909,14.561,9.349,17.369,12c14.028,13.241,18.449,27.75,16.615,43.337 c3.379-6.256,6.451-12.839,11.618-18.341c7.261-7.732,19.534-14.866,32.915-16.022c-1.185,3.604-2.353,7.007-4.418,10.349 c-5.105,7.017-13.326,12.682-23.828,15.188c-1.885,0.449-6.706,0.937-7.836,1.896c-1.468,1.249-1.944,3.254-2.774,4.795 c-2.044,3.798-4.111,7.761-6.549,11.398c-0.412,0.613-0.416,1.399-1.057,1.899l-0.256-0.098l0.354,0.04l-0.384-0.228 c-0.588-1.648-0.188-4.3-0.325-6.063c-0.406-5.245-1.175-10.526-1.295-15.758c-6.308-2.269-12.208-6.359-16.571-10.415 C101.365,26.613,97.808,15.525,99.072,3.122z"/>
                <ellipse fill="#FFFFFF" cx="136.459" cy="158.148" rx="104.75" ry="90"/>
                <path fill="#fa186b" d="M263.99,97.083c4.413-10.62,4.357-23.706-0.136-34.293 c-0.281-0.66-0.579-1.313-0.893-1.959c-0.313-0.646-0.643-1.283-0.987-1.912s-0.705-1.25-1.08-1.862 c-0.375-0.611-0.766-1.213-1.17-1.806c-0.405-0.593-0.825-1.175-1.258-1.747c-0.434-0.572-0.881-1.133-1.342-1.683 c-0.461-0.55-0.936-1.088-1.423-1.615c-0.487-0.527-0.987-1.042-1.5-1.544s-1.037-0.992-1.573-1.468 c-0.537-0.476-1.085-0.939-1.645-1.389s-1.129-0.885-1.71-1.307c-0.581-0.421-1.171-0.829-1.771-1.221 c-0.602-0.393-1.211-0.771-1.83-1.133c-0.62-0.363-1.247-0.71-1.884-1.042c-0.637-0.332-1.28-0.647-1.933-0.948 c-0.651-0.3-1.31-0.584-1.976-0.852c-0.71-0.279-1.426-0.541-2.147-0.784c-0.722-0.244-1.449-0.469-2.183-0.676 c-0.733-0.207-1.472-0.395-2.214-0.566c-0.743-0.17-1.49-0.321-2.24-0.454c-0.75-0.132-1.503-0.247-2.259-0.342 c-0.757-0.095-1.515-0.171-2.274-0.228c-0.76-0.057-1.521-0.096-2.283-0.115c-0.762-0.02-1.523-0.02-2.285,0 c-0.762,0.019-1.522,0.057-2.282,0.114c-0.761,0.057-1.519,0.133-2.274,0.228c-0.756,0.095-1.509,0.208-2.259,0.341 c-0.751,0.133-1.497,0.284-2.24,0.454c-0.743,0.169-1.481,0.357-2.215,0.565c-0.733,0.207-1.461,0.432-2.184,0.675 c-0.722,0.243-1.438,0.504-2.146,0.783c-0.709,0.279-1.411,0.576-2.105,0.89c-9.994,4.403-18.468,13.658-22.358,23.799 c-0.521,1.366-1.031,2.736-1.533,4.109c-3.919-1.99-8.175-4.087-12.448-5.141c-3.223-0.795-6.688-1.087-9.807-2.233 c-2.671-0.981-4.833-3.126-7.238-4.594c-6.376-3.892-16.206-4.753-23.242-2.412c-4.457,1.483-7.943,3.911-11.349,7.084 c-7.61,0.59-16.309,3.181-22.902,7.02c-0.222-0.722-0.462-1.438-0.72-2.147c-0.257-0.71-0.532-1.413-0.825-2.108 c-0.293-0.696-0.604-1.384-0.931-2.064c-0.327-0.681-0.672-1.353-1.033-2.015s-0.738-1.316-1.133-1.96 c-0.394-0.644-0.804-1.278-1.229-1.901c-0.427-0.624-0.868-1.236-1.324-1.837c-0.457-0.601-0.928-1.19-1.414-1.768 c-0.486-0.578-0.987-1.142-1.502-1.694c-0.515-0.552-1.043-1.091-1.585-1.617c-0.542-0.525-1.097-1.037-1.664-1.535 c-0.568-0.498-1.147-0.981-1.739-1.45c-0.592-0.469-1.195-0.922-1.81-1.36c-0.615-0.438-1.24-0.861-1.876-1.268 c-0.637-0.407-1.282-0.797-1.938-1.172c-0.656-0.375-1.32-0.732-1.994-1.073c-6.659-3.451-15.381-5.298-22.876-4.596 C35.41,37.238,24.81,42.417,16.701,51.95c-6.476,7.613-10.809,20.208-9.928,30.273c1.126,12.85,6.458,24.069,16.502,32.353 c2.9,2.391,6.068,4.083,9.473,5.637c-2.015,3.094-3.431,6.315-4.491,9.85c-0.515,1.72-0.891,3.562-1.556,5.226 c-0.888,2.221-2.516,4.219-3.656,6.322c-2.956,5.447-3.572,12.67-2.301,18.678c1.238,5.857,5.277,12.663,10.39,15.942 c0.489,0.313,1.016,0.563,1.546,0.8c-1.84,7.243-2.134,15.08,1.791,21.713c2.703,4.567,6.207,7.541,10.981,9.736 c-0.095,7.02,1.682,13.167,6.663,18.259c0.235,0.245,0.478,0.483,0.725,0.716s0.5,0.459,0.759,0.678 c0.259,0.22,0.522,0.434,0.792,0.64s0.544,0.407,0.823,0.601c0.278,0.191,0.563,0.378,0.851,0.557 c0.289,0.18,0.582,0.351,0.878,0.515c0.298,0.164,0.599,0.321,0.903,0.47c0.305,0.15,0.613,0.291,0.925,0.426 c0.313,0.134,0.627,0.26,0.945,0.377c0.318,0.119,0.64,0.229,0.963,0.332c0.323,0.102,0.649,0.195,0.978,0.281 s0.659,0.164,0.991,0.233s0.666,0.132,1.001,0.185c0.336,0.053,0.672,0.096,1.01,0.133c0.337,0.036,0.675,0.064,1.015,0.082 c0.339,0.02,0.678,0.031,1.017,0.033c0.639,0.004,1.27-0.009,1.904-0.058c0.452,5.14,3.413,9.356,7.311,12.586 c4.679,3.876,10.39,5.295,16.375,4.685c0.608-0.064,1.216-0.133,1.823-0.203c2.915,4.729,6.48,8.531,12.061,9.881 c4.326,1.046,10.47,0.894,14.304-1.588c0.11-0.071,0.218-0.146,0.327-0.219c0.39,0.525,0.804,1.032,1.243,1.519 c0.438,0.486,0.899,0.95,1.383,1.393s0.987,0.86,1.511,1.255c0.524,0.393,1.065,0.76,1.625,1.102s1.134,0.654,1.723,0.941 c0.59,0.285,1.191,0.543,1.806,0.771c0.613,0.228,1.237,0.425,1.871,0.593c0.633,0.168,1.273,0.305,1.92,0.411 c5.319,0.821,11.121-0.295,15.471-3.547c1.705-1.276,3.102-2.808,4.523-4.386c3.626,2.509,9.047,2.836,13.291,2.031 c4.85-0.922,9.044-4.068,11.757-8.123c0.456-0.681,0.874-1.384,1.253-2.111c5.65,1.147,11.347,0.191,16.19-2.973 c5.208-3.402,7.273-8.197,9.313-13.848c6.293-0.253,11.865-1.876,16.282-6.631c1.012-1.089,2.012-2.398,2.727-3.703 c2.375-4.684,2.813-8.275,2.852-13.495c0.055-0.054,0.106-0.108,0.161-0.162c1.585-1.526,3.724-2.366,5.465-3.692 c5.347-4.066,8.608-11.125,8.847-17.762c0.131-3.662-0.72-6.785-1.569-10.304c6.468-4.319,11.157-9.835,12.713-17.626 c1.113-5.579,0.436-12.388-2.148-17.499c-1.121-2.217-2.685-4.285-3.58-6.608c-0.894-2.314-1.187-4.887-1.966-7.254 c-0.94-2.858-2.496-5.509-3.806-8.21C251.882,115.901,259.77,107.239,263.99,97.083z"/>
                <path fill="#FEFEFE" d="M88.083,137.648c0.855-0.054,1.579-0.041,2.399,0.241c1.447,0.497,2.688,1.406,3.346,2.819 c0.461,0.992,0.541,2.195,0.146,3.223c-0.538,1.403-1.803,2.393-3.146,2.967c-0.904,0.064-1.922,0.174-2.814-0.006 c-1.239-0.249-2.47-1.052-3.133-2.137c-0.08-0.134-0.152-0.271-0.218-0.413c-0.065-0.142-0.123-0.287-0.174-0.434 c-0.05-0.148-0.092-0.298-0.126-0.45c-0.033-0.152-0.06-0.306-0.076-0.461c-0.019-0.155-0.028-0.31-0.029-0.466 c-0.001-0.156,0.006-0.312,0.021-0.467c0.016-0.155,0.039-0.309,0.071-0.461c0.031-0.153,0.071-0.303,0.119-0.452 C85.072,139.217,86.406,138.513,88.083,137.648z"/>
                <path fill="#FEFEFE" d="M184.78,137.706c0.997,0.142,2.028,0.338,2.916,0.833c1.132,0.631,1.995,1.756,2.284,3.022 c0.037,0.156,0.065,0.313,0.085,0.473c0.02,0.16,0.031,0.319,0.034,0.479s-0.003,0.32-0.018,0.479 c-0.014,0.16-0.036,0.319-0.066,0.476c-0.031,0.158-0.069,0.313-0.117,0.466c-0.047,0.153-0.103,0.304-0.166,0.451 c-0.063,0.147-0.134,0.291-0.212,0.431c-0.079,0.14-0.164,0.275-0.257,0.406c-1.017,1.425-2.348,1.863-4.01,2.104 c-0.749-0.084-1.557-0.138-2.256-0.435c-1.171-0.498-2.185-1.473-2.617-2.678c-0.436-1.21-0.299-2.539,0.303-3.665 C181.589,138.854,183.026,138.255,184.78,137.706z"/>
                <path fill="#FEFEFE" d="M133.886,151.753c10.601-1.056,22.3,2.9,30.527,9.527c8.747,7.047,15.021,17.087,16.227,28.368 c1.209,11.307-1.706,22.734-8.951,31.609c-8,9.802-18.968,15.074-31.419,16.363c-10.938,1.187-23.034-2.627-31.562-9.464 c-0.56-0.448-1.107-0.909-1.644-1.384c-0.536-0.476-1.061-0.963-1.572-1.464c-0.513-0.501-1.012-1.015-1.499-1.54 s-0.961-1.063-1.421-1.611s-0.907-1.109-1.34-1.68c-0.433-0.571-0.851-1.152-1.255-1.744s-0.793-1.193-1.168-1.804 c-0.374-0.61-0.732-1.23-1.077-1.859c-0.343-0.628-0.671-1.265-0.983-1.909c-0.313-0.646-0.608-1.297-0.889-1.957 c-0.279-0.659-0.543-1.325-0.791-1.998c-0.247-0.672-0.478-1.35-0.691-2.033c-0.214-0.685-0.41-1.373-0.59-2.066 c-0.181-0.693-0.343-1.391-0.487-2.093c-0.146-0.702-0.273-1.406-0.384-2.114c-0.111-0.707-0.204-1.417-0.279-2.13 c-1.166-11.093,2.571-22.446,9.568-31.065C110.517,157.467,121.056,153.033,133.886,151.753z"/>
                <path fill="#170338" d="M116.251,185.274c-0.372-1.446-0.417-2.706,0.331-4.052c0.658-1.184,1.919-2.242,3.238-2.588 c3.233-0.846,26.945-0.715,31.435-0.385c1.229,0.09,2.878,0.193,3.934,0.856c1.196,0.752,2.048,1.709,2.396,3.104 c0.413,1.658,0.041,3.144-0.527,4.711c-0.388,1.013-0.837,1.945-1.387,2.881c-3.592,6.117-9.818,10.951-16.694,12.74 c0.009,3.357-0.568,11.172,0.506,13.943c0.906,2.332,2.88,3.971,5.166,4.869c2.874,1.127,5.486,0.919,8.257-0.32 c3.37-1.506,3.152-2.82,4.43-5.803c0.336-0.785,0.746-1.259,1.537-1.602c0.647,0.047,1.008,0.082,1.475,0.58 c0.604,0.644,0.809,1.69,0.792,2.543c-0.046,2.33-1.487,4.601-3.136,6.153c-2.653,2.5-6.551,3.765-10.168,3.601 c-4.733-0.215-8.033-2.438-11.112-5.889c-1.847,2.375-4.146,4.1-6.992,5.094c-0.439,0.158-0.887,0.292-1.34,0.403 s-0.911,0.2-1.373,0.265c-0.463,0.065-0.927,0.106-1.394,0.125c-0.467,0.018-0.934,0.011-1.399-0.02 c-0.466-0.029-0.93-0.083-1.39-0.16c-0.461-0.077-0.916-0.178-1.366-0.301c-0.451-0.123-0.894-0.27-1.329-0.438 c-0.436-0.169-0.861-0.359-1.277-0.571c-2.826-1.419-5.912-4.704-6.771-7.865c-0.229-0.842,0.041-2.041,0.506-2.762 c0.429-0.666,0.873-0.798,1.62-0.931c2.104,0.713,2.618,4.543,4.192,6.215c1.531,1.629,4.267,2.375,6.436,2.427 c2.559,0.062,5.392-0.944,7.196-2.794c3.659-3.751,2.385-12.003,2.299-16.916c-1.834-0.426-3.543-1.23-5.169-2.164 C123.758,197.118,117.896,191.494,116.251,185.274z"/>
                <path fill="#010013" d="M116.251,185.274c-0.372-1.446-0.417-2.706,0.331-4.052c0.658-1.184,1.919-2.242,3.238-2.588 c3.233-0.846,26.945-0.715,31.435-0.385c1.229,0.09,2.878,0.193,3.934,0.856c1.196,0.752,2.048,1.709,2.396,3.104 c0.413,1.658,0.041,3.144-0.527,4.711c-0.278-0.908,0.068-1.838,0.167-2.765c0.214-2.012-0.603-2.971-1.812-4.417 c-3.27-1.449-7.212-0.988-10.719-0.949c2.704,0.071,5.37,0.059,8.042,0.522c-6.122-0.087-12.25-0.054-18.373-0.065 c-4.843-0.01-9.726-0.188-14.546,0.338c-1.333,1.174-2.686,2.56-3.017,4.381C116.698,184.526,116.564,184.797,116.251,185.274z"/>
                <path fill="#170338" d="M80.925,79.625c-1.793-12.446-13.531-22.06-27.754-22.06c-15.464,0-28,11.361-28,25.375 c0,11.498,8.44,21.203,20.01,24.321C46.991,92.309,62.117,80.519,80.925,79.625z"/>
                <path fill="#170338" d="M193.459,76.451c1.793-12.446,13.531-22.06,27.754-22.06c15.464,0,28,11.361,28,25.375 c0,11.498-8.44,21.203-20.01,24.321C227.393,89.134,212.266,77.344,193.459,76.451z"/>
              </svg>
              <span className='text-white font-bold text-2xl'>PromptBär</span>
            </Link> 
          </div>
          <div className="hidden md:block">
            <div className="ml-10 flex items-baseline space-x-4">
              {navItems.map((item) => (
                <Link
                  key={item.name}
                  href={item.href}
                  className="text-foreground hover:text-primary px-3 py-2 rounded-md text-lg transition-colors"
                >
                  {item.name}
                </Link>
              ))}
            </div>
          </div>
          <div className="hidden md:block">
            {session?.user ? (
              <div className="flex items-center gap-4">
                <Button variant="ghost" asChild>
                  <Link href="/auth/profile">
                    Profil
                  </Link>
                </Button>
                <Button variant="outline" onClick={handleLogout}>
                  Logout
                </Button>
              </div>
            ) : (
              <>
                <Button variant="outline" className="mr-4" asChild>
                  <Link href="/auth/login">
                    Login
                  </Link>
                </Button>
                <Button asChild>
                  <Link href="/auth/register">
                    Kostenlos starten
                  </Link>
                </Button>
              </>
            )}
          </div>
          <div className="md:hidden">
            <Button variant="ghost" size="icon" onClick={() => setIsOpen(!isOpen)}>
              <span className="sr-only">Open main menu</span>
              {isOpen ? (
                <X className="h-6 w-6" aria-hidden="true" />
              ) : (
                <Menu className="h-6 w-6" aria-hidden="true" />
              )}
            </Button>
          </div>
        </div>
      </div>

      {isOpen && (
        <div className="md:hidden">
          <div className="px-2 pt-2 pb-3 space-y-1">
            {navItems.map((item) => (
              <Link
                key={item.name}
                href={item.href}
                className="text-foreground hover:text-primary hover:bg-accent block px-3 py-2 rounded-md text-base font-medium"
                onClick={() => setIsOpen(false)}
              >
                {item.name}
              </Link>
            ))}
          </div>
          <div className="pt-4 pb-3 border-t border-border">
            <div className="px-2 space-y-1">
              {session?.user ? (
                <>
                  <Button variant="ghost" className="w-full mb-2" asChild>
                    <Link href="/auth/profile">
                      Profil
                    </Link>
                  </Button>
                  <Button variant="outline" className="w-full" onClick={handleLogout}>
                    Logout
                  </Button>
                </>
              ) : (
                <>
                  <Button variant="outline" className="w-full mb-2" asChild>
                    <Link href="/auth/login">
                      Login
                    </Link>
                  </Button>
                  <Button className="w-full" asChild>
                    <Link href="/auth/register">
                      Kostenlos starten
                    </Link>
                  </Button>
                </>
              )}
            </div>
          </div>
        </div>
      )}
    </nav>
  )
}
